<!DOCTYPE html>
<html lang="tr">
<head>
Â  <meta charset="UTF-8">
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  <title>QR Panel</title>
Â  <script src="https://cdn.tailwindcss.com"></script>
Â  <style>
Â  Â  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
Â  Â  body {
Â  Â  Â  text-align: center;
Â  Â  Â  font-family: 'Inter', sans-serif;
Â  Â  Â  background: #f4f4f4;
Â  Â  }
Â  Â  #qrcode {
Â  Â  Â  margin: 40px auto;
Â  Â  }
Â  </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col items-center justify-center p-4">

Â  <div class="bg-white p-8 rounded-lg shadow-xl max-w-sm w-full">
Â  Â  <h1 class="text-3xl font-bold text-gray-800 mb-6">ğŸ“Œ KiÅŸiye Ã–zel QR Kod</h1>
Â  Â  <div id="qrcode" class="flex justify-center mb-6"></div>
Â  Â  <p id="qrText" class="text-lg font-semibold text-center mt-6 text-gray-700"></p>
Â  Â  <p id="thankYou" class="text-sm text-center mt-2 text-gray-500"></p>
Â  </div>

Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
Â  <script type="module">
Â  Â  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
Â  Â  import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

Â  Â  // Firebase yapÄ±landÄ±rma bilgileri
Â  Â  const firebaseConfig = {
Â  Â  Â  apiKey: "AIzaSyAZxHq28my4VLR-xX94wvkr6Gf-ohyeH98",
Â  Â  Â  authDomain: "e-y-yonetici.firebaseapp.com",
Â  Â  Â  projectId: "e-y-yonetici"
Â  Â  };

Â  Â  // Firebase'i baÅŸlatma ve Firestore'u alma
Â  Â  const app = initializeApp(firebaseConfig);
Â  Â  const db = getFirestore(app);

Â  Â  // URL parametrelerini alarak 'id' deÄŸerini Ã§Ä±karma
Â  Â  const urlParams = new URLSearchParams(window.location.search);
Â  Â  const id = urlParams.get("id");

Â  Â  // Firestore'dan veri Ã§ekme fonksiyonu
Â  Â  async function fetchData() {
Â  Â  Â  if (!id) {
Â  Â  Â  Â  document.getElementById("qrText").textContent = "âŒ Kimlik bilgisi eksik.";
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  // Firestore'da belirtilen belgeye referans oluÅŸturma
Â  Â  Â  const docRef = doc(db, "bekleyen_rezervasyonlar", id);
Â  Â  Â  
Â  Â  Â  try {
Â  Â  Â  Â  // Belgeyi Firestore'dan Ã§ekme
Â  Â  Â  Â  const docSnap = await getDoc(docRef);

Â  Â  Â  Â  // Belgenin var olup olmadÄ±ÄŸÄ±nÄ± kontrol etme
Â  Â  Â  Â  if (docSnap.exists()) {
Â  Â  Â  Â  Â  const data = docSnap.data();
Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  // Verileri ilgili HTML elementlerine yerleÅŸtirme
Â  Â  Â  Â  Â  document.getElementById("qrText").textContent = data.qrCodeDisplayText || "Metin bulunamadÄ±.";
Â  Â  Â  Â  Â  document.getElementById("thankYou").textContent = data.thankYouMessage || "TeÅŸekkÃ¼r mesajÄ± bulunamadÄ±.";
Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  // QR kodu oluÅŸturma
Â  Â  Â  Â  Â  const qrDiv = document.getElementById("qrcode");
Â  Â  Â  Â  Â  if (qrDiv && data.qrCodeContent) {
Â  Â  Â  Â  Â  Â  new QRCode(qrDiv, {
Â  Â  Â  Â  Â  Â  Â  text: data.qrCodeContent, // BurasÄ± gÃ¼ncellendi.
Â  Â  Â  Â  Â  Â  Â  width: 128,
Â  Â  Â  Â  Â  Â  Â  height: 128
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  // Belge bulunamadÄ±ysa hata mesajÄ± gÃ¶sterme
Â  Â  Â  Â  Â  document.getElementById("qrText").textContent = "âŒ Veri bulunamadÄ±.";
Â  Â  Â  Â  Â  console.log("Belge bulunamadÄ±!");
Â  Â  Â  Â  }
Â  Â  Â  } catch (error) {
Â  Â  Â  Â  // Hata durumunda konsola ve ekrana hata mesajÄ± yazdÄ±rma
Â  Â  Â  Â  document.getElementById("qrText").textContent = "âŒ Veri Ã§ekerken bir hata oluÅŸtu.";
Â  Â  Â  Â  console.error("Veri Ã§ekme hatasÄ±: ", error);
Â  Â  Â  }
Â  Â  }

Â  Â  // Sayfa yÃ¼klendiÄŸinde fetchData fonksiyonunu Ã§aÄŸÄ±rma
Â  Â  fetchData();
Â  </script>

</body>
</html>
